<!DOCTYPE html>
<html>
<!-- from Mike Bostock: https://gist.github.com/mbostock/a84aeb78fea81e1ad806 -->
<head>
  <title>d3-practice</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <script type="text/javascript" <script src="https://d3js.org/d3.v4.min.js"></script>

  <script src="https://d3js.org/d3-dispatch.v1.min.js"></script>
  <script src="https://d3js.org/d3-selection.v1.min.js"></script>
  <script src="https://d3js.org/d3-drag.v1.min.js"></script>

  <style>
    html, body {
      height: 100%;
      margin: 0;
      overflow: hidden;
    }
    svg {
      position: absolute;
    }
      /*.active {
        stroke: #000;
        stroke-width: 2px;
      }*/
  </style>
</head>

<body>

  <!-- <svg width="960" height="800"></svg> -->

  <script>

    var width = self.frameElement ? 960 : innerWidth,
        height = self.frameElement ? 500 : innerHeight;

    var data = d3.range(20).map(function() { return [Math.random() * width, Math.random() * height]; });

    var color = d3.scaleOrdinal();

    var drag = d3.drag()
        // what is origin?
        // Uncaught TypeError: d3.drag(...).origin is not a function 
        .origin(function(d) { return {x: d[0], y: d[1]}; })
        .on("dragstart", dragstarted)
        .on("drag", dragged)
        .on("dragend", dragended);

    d3.select("body")
        .on("touchstart", nozoom)
        .on("touchmove", nozoom)
      .append("svg")
        .attr("width", width)
        .attr("height", height)
      .selectAll("circle")
        .data(data)
      .enter().append("circle")
        .attr("transform", function(d) { return "translate(" + d + ")"; })
        .attr("r", 32)
        .style("fill", function(d, i) { return color(i); })
        .call(drag);

    function dragstarted() {
      this.parentNode.appendChild(this);

      d3.select(this).transition()
          .ease("elastic")
          .duration(500)
          .attr("r", 48);
    }

    function dragged(d) {
      d[0] = d3.event.x;
      d[1] = d3.event.y;

      d3.select(this)
          .attr("transform", "translate(" + d + ")");
    }

    function dragended() {
      d3.select(this).transition()
          .ease("elastic")
          .duration(500)
          .attr("r", 32);
    }

    function nozoom() {
      d3.event.preventDefault();
    }

</script>
</body>
</html>
